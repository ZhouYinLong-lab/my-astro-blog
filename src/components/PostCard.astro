---
import { DATE_FORMAT } from "@config";
import type { PostData } from "@interfaces/data";
import dayjs from "@utils/dayjs";
import { Icon } from "astro-icon/components";
import Card from "./temple/Card.astro";
import Heading from "./widgets/Heading.astro";
import PostFilter from "./widgets/PostFilter.astro";
import PostInfo from "./widgets/PostInfo.astro";

const {
  title,
  image,
  cover,
  pubDate,
  description,
  badge,
  categories = [],
  tags = [],
  word = "0",
  time = "0",
  url = decodeURIComponent(Astro.url.toString()),
} = Astro.props as any;

const displayDate = pubDate ? dayjs(pubDate).format(DATE_FORMAT) : "";
const displayImage = image || cover;
---

<Card class="overflow-hidden post-card">
  <div class="flex flex-col md:flex-row">
    <div class="flex-1 p-6 overflow-hidden bg-base-100 md:order-1 order-2 flex flex-col justify-between post-content">
      <div>
        <PostInfo pubDate={displayDate} badge={badge} word={word} time={time} />
        <Heading url={url} title={title}>{title}</Heading>
        <p class="text-sm text-base-content/70 mb-4">{description}</p>
      </div>
      <PostFilter categories={categories} tags={tags} />
    </div>

    {
      displayImage && (
        <a href={url} class="relative md:w-1/3 aspect-video md:aspect-auto overflow-hidden md:order-2 order-1 group post-img">
          <div class="absolute inset-0 bg-black/0 group-hover:bg-black/60 z-10 transition-all duration-300 flex items-center justify-center">
            <Icon
              name="lucide:arrow-right"
              class="w-12 h-12 text-white opacity-0 group-hover:opacity-100 transition-all duration-300 transform group-hover:translate-x-2"
            />
          </div>
          <img
            src={displayImage}
            alt={title}
            loading="lazy"
            class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
          />
        </a>
      )
    }
  </div>
</Card>

<style is:global>
  @media (min-width: 768px) {
    .post-card:nth-child(even) .post-content {
      order: 2 !important;
    }
    .post-card:nth-child(even) .post-img {
      order: 1 !important;
    }
  }
</style>